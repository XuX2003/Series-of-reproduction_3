function y = loops(L, n)if ~isa(L,'struct')     error('Input matrix is not a structure array.');endtotels = 0;if nargin == 2    nl=size(nonzeros(L.fbl(:,1)),1);	% number of loops -- loops are id by having the first col<>0    if n<1 | n>nl         error('Loop index exceeds loops in cycle.');    else        fprintf('  Loop %2.0f and its char. and total elast.:\n',n);           fprintf('   ');        fprintf(L.nms(L.fbl(n,1),:));   % display the first stage/age-group in sequence        lplngth = nnz(L.fbl(n,:));      % identify the length of loop i        for j=2:lplngth                 % display the others in loop i            fprintf(' --> ');            fprintf(L.nms(L.fbl(n,j),:));        end                             % end of for-j        fprintf(' --> ');               % display the first stage/age-group at the end of the sequence as well        fprintf(L.nms(L.fbl(n,1),:));        lpels = lplngth * L.els(1,n);   % compute the loop elasticity                fprintf('\t\t%3.4f\t%3.3f',L.els(1,n),lpels);% display the characteristic and total elasticity of loop i        fprintf('\n');    endelseif nargin == 1    nl=size(nonzeros(L.fbl(:,1)),1);	% number of loops -- loops are id by having the first col<>0    for i=1:nl							% for each loop i        fprintf('  Loop %2.0f and its char. and total elast.:\n',i);           fprintf('   ');        fprintf(L.nms(L.fbl(i,1),:));   % display the first stage/age-group in sequence        lplngth = nnz(L.fbl(i,:));      % identify the length of loop i        for j=2:lplngth                 % display the others in loop i            fprintf(' --> ');            fprintf(L.nms(L.fbl(i,j),:));        end                             % end of for-j        fprintf(' --> ');               % display the first stage/age-group at the end of the sequence as well        fprintf(L.nms(L.fbl(i,1),:));        lpels = lplngth * L.els(1,i);   % compute the loop elasticity        totels = totels + lpels;        fprintf('\t\t%3.4f\t%3.3f',L.els(1,i),lpels);% display the characteristic and total elasticity of loop i        fprintf('\n');    end                                 % end of for-i    fprintf('Total elasticity: %3.3f\n',totels);end                                     % end of if-nargin